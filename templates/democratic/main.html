<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/static/css/reset.css"/>
    <link rel="stylesheet" href="/static/css/toup.css"/>
    <link rel="stylesheet" href="/static/css/swiper.min.css">
    <link rel="stylesheet" href="/static/css/jquery-labelauty.css">
    <script src="/static/plugins/layui/layui.js"></script>

    <!--<link rel="stylesheet" href="/static/css/city.css">-->
    <!--<script src="/static/js/ydui.flexible.js"></script>-->
    <style>
        ul {
            list-style-type: none;
        }

        li {
            display: block;
            /*display: inline-block;*/
            margin: -10px 0;
        }

        input.labelauty + label {
            font: 12px "Microsoft Yahei";
            color: black;
            padding: 12px;
        }
    </style>
    <script src="/static/js/jquery-1.12.4.min.js"></script>
    <script src="/static/js/fontSize.js"></script>

    <title>高校家庭经济困难学生班级民主评议表</title>

</head>

<body>

<section class="toup" id="t1">
    <div class="swipers">
        <!-- 热爱所学专业，刻苦钻研，勇于创新，敢于实践，积极参加课外科技活动 -->
        <div class="swiper-container swiper-no-swiping">
            <div class="swiper-wrapper swiper-no-swiping">

                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>1</span>热爱所学专业，刻苦钻研，勇于创新，敢于实践，积极参加课外科技活动</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_zcdd" data-labelauty="好（2分）">
                                </li>
                                <li><input type="radio" name="radio_zcdd" data-labelauty="一般（1分）"></li>
                                <li><input type="radio" name="radio_zcdd" data-labelauty="差（0分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!--尊敬师长、尊重他人，团结友爱、关心集体、诚实守信，考试不作弊；热爱劳动，积极参加社会实践、公益劳动-->
                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>2</span>尊敬师长、尊重他人，团结友爱、关心集体、诚实守信，考试不作弊；热爱劳动，积极参加社会实践、公益劳动</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_zcdd" data-labelauty="好（2分）">
                                </li>
                                <li><input type="radio" name="radio_zcdd" data-labelauty="一般（1分）"></li>
                                <li><input type="radio" name="radio_zcdd" data-labelauty="差（0分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!--父亲职业-->
                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>3</span>个人购买使用手机价格</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_fqzy" data-labelauty="3000元以上（0分）"></li>
                                <li><input type="radio" name="radio_fqzy" data-labelauty="1000-3000元（1分）"
                                ></li>
                                <li><input type="radio" name="radio_fqzy" data-labelauty="1000元以下（2分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!--是否拥有多件品牌服装、化妆品、鞋、帽、包等-->
                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>4</span>是否拥有多件品牌服装、化妆品、鞋、帽、包等</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_mqzy" data-labelauty="有（0分）"></li>
                                <li><input type="radio" name="radio_mqzy" data-labelauty="无（2分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!--每月平均伙食开支费用-->
                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>5</span>每月平均伙食开支费用</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_fqld" data-labelauty="高于一般水平（0分）"></li>
                                <li><input type="radio" name="radio_fqld" data-labelauty="等于一般水平（2分）"></li>
                                <li><input type="radio" name="radio_fqld" data-labelauty="低于一般水平（5分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!--是否出入高档酒店、娱乐场所等高消费场所-->
                <div class="swiper-slide swiper-no-swiping">
                    <div class="scores">
                        <div class="f"><span>6</span>是否出入高档酒店、娱乐场所等高消费场所</div>
                        <div class="choose">
                            <ul class="dowebok">
                                <li><input type="radio" name="radio_mqld" data-labelauty="有（0分）"></li>
                                <li><input type="radio" name="radio_mqld" data-labelauty="无（2分）"></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 上下start -->
            <div class="preNexts">
                <div class="swiper-button-prev">
                    <div class="pre"></div>
                    上一题
                </div>
                <div class="swiper-button-next">
                    <div class="next"></div>
                    下一题
                </div>
            </div>
        </div>
        <!-- 上下end -->
    </div>
</section>


<script src="/static/js/jquery-1.12.4.min.js"></script>
<script src="/static/plugins/layui/layui.js"></script>
<script src="/static/js/layuiConfig.js"></script>
<script src="/static/js/fontSize.js"></script>
<script src="/static/js/swiper.min.js"></script>
<script src="/static/js/jquery-labelauty.js"></script>
<script src="/static/js/calcDemocraticScore.js"></script>

<script>


    layui.use(['jquery', 'layer', 'form', "jquery_cookie"], function () {
        var $ = layui.jquery;
        var filledStudentId = $.cookie("filled_student_id");
        var layer = layui.layer;
        var value_array = {};
        var value_name = ['xxtd', 'pdxy', 'sjxf', 'rcyz', 'hsxf', 'qtgd'];
        var score_array = [];
        var presend_array = {};
        var mySwiper = new Swiper('.swiper-container', {
            noSwiping: true,
            pagination: '.swiper-pagination ',
//            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            slidesPerView: 1,
            paginationClickable: false,
            spaceBetween: 100,
            loop: false
        });
        $("#t2").hide();


        $(".swiper-container label,.swiper-container input[id!='J_Address']").click(function () {
            var this_active = $(this).parents(".swiper-slide").index();
            setTimeout(function () {
                logic(mySwiper);
//                mySwiper.activeIndex
                mySwiper.slideTo(mySwiper.activeIndex + 1, 1000)
//                $('.swiper-button-next').click();
            }, 500);
        });
        $('.swiper-button-next').click(function () {
            mySwiper.slideTo(mySwiper.activeIndex + 1, 1000)
            logic(mySwiper);
        });


//        获取当前swiper被选择的radio的值
        function getActiveValue(now_index) {
            console.log(now_index)
            var active_slide = mySwiper.slides[now_index];
            var radio = $(active_slide).find($(':input:radio:checked'))[0];
            var label = $($(radio)).next().children()[1];
            return $(label).html();
        }

//         回退swiper并提示
        function back(now_index) {
            layer.msg("您还未选择!");
            mySwiper.slideTo(now_index - 1);
        }

        $(':input:checkbox').labelauty();
        $(':input:radio').labelauty();

//        主要逻辑
        function logic(mySwiper) {
            var now_index = mySwiper.activeIndex;
            var active_value;

            active_value = getActiveValue(now_index);
            if (typeof(active_value) === "undefined") {
                back(now_index);
                return;
            }
            console.log(value_array);

//            记录 & 计分
            var score = calcDemocraticScore(now_index, active_value);
//            alert(score);
            score_array[now_index] = score;
            value_array[value_name[now_index]] = active_value;

            if (mySwiper.isEnd) {
                var sum = 0;
                score_array.forEach(function (t) {
                    sum += t;
                });
                presend_array['filledStudentId'] = filledStudentId;
                presend_array['score'] = sum;
                console.log(presend_array);
                $.ajax(
                    {
                        url: "/democratic/main_handler/",
                        async: true,
                        data: presend_array,
                        type: "post",
                        dataType: "json",
                        success: function (data) {
                            if (data.result === "error") {
                                layer.msg("数据出错");
                            } else if (data.result === "ok") {
                                layer.msg("提交成功，请签名");
                                setTimeout("window.location.href='/democratic/signature/'", 800)
                            }
                        },
                        error: function () {
                            console.log(value_array);
                            layer.msg("提交出错");
                        }
                    }
                )
            }
        }
    });


</script>


<div style="text-align:center;margin:30px 0; font:normal 14px/24px 'MicroSoft YaHei';">
    <p>Powered by：<a>福信-易班开发团队</a></p>
</div>
</body>

</html>